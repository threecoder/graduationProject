(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aed64ba2"],{1262:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"all-container"},[n("h3",[t._v("已发布的活动")]),n("div",{staticClass:"divider"}),n("div",{staticClass:"table-container"},[n("m-table",{attrs:{data:t.activityTable.tableData,tableConfig:t.activityTable.tableConfig,loading:t.activityTable.loading,tableAttr:t.activityTable.tableAttr},scopedSlots:t._u([{key:"oper",fn:function(e){var a=e.params;return n("el-table-column",t._b({staticClass:"myoper",attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return n("div",{},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.checkDetail(a)}}},[t._v("更多")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleSEAT(a)}}},[t._v("手动排座")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.autoSEAT(a)}}},[t._v("自动排座")])],1)}}])},"el-table-column",a,!1))}}])})],1),n("el-drawer",{staticClass:"drawer-container",attrs:{title:"活动详情",visible:t.drawer,size:"30%"},on:{"update:visible":function(e){t.drawer=e}}},[n("div",{staticClass:"tac"},[n("h3",[t._v(t._s(t.drwaerInfo.name))]),n("p",[t._v("活动时间："+t._s(t.drwaerInfo.date))]),n("p",[t._v("活动地点："+t._s(t.drwaerInfo.address))]),n("p",[t._v("活动开发时间："+t._s(t.drwaerInfo.openDate))]),n("p",[t._v("报名人数："+t._s(t.drwaerInfo.joinNum))])]),n("div",{staticClass:"divider"}),n("div",{staticClass:"activity-detail"},[t._l(t.drwaerInfo.introduce,(function(e,a){return n("p",{key:a},[t._v(t._s(e))])})),n("p",[t._v("如有疑问，请联系："+t._s(t.drwaerInfo.contacts)+"。")]),n("p",[t._v("联系电话："+t._s(t.drwaerInfo.phone)+"。")])],2),n("div",{staticClass:"drawer-footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.exportEntryForm}},[t._v("导出报名表")])],1)]),t.flag?n("el-dialog",{ref:"dialog",attrs:{title:"座位信息",visible:t.flag,fullscreen:"","before-close":t.beforeClose},on:{"update:visible":function(e){t.flag=e}}},[t.tableFlag?n("s-table",{attrs:{attr:t.seatInfo,Arr:t.seatInfo.arr},on:{lock:t.handleLock,num:t.handleNum}}):t._e(),n("div",{staticClass:"button-container"},[n("el-button",{attrs:{type:"primary"},on:{click:t.saveSEAT}},[t._v("保存座位信息")])],1)],1):t._e()],1)},r=[],i=(n("c5f6"),n("04ff"),n("28a5"),n("96cf"),n("1da1")),s=n("d2a2"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"all-container"},[n("div",{staticClass:"panel"},[n("el-input",{ref:"input",attrs:{autofocus:"",disabled:t.tem.lock,placeholder:"输入人员编号，编号查看导出的报名表"},model:{value:t.tem.num,callback:function(e){t.$set(t.tem,"num",e)},expression:"tem.num"}}),n("el-button",{attrs:{size:"small",type:"primary",disabled:t.tem.x<1||t.tem.y<1},on:{click:t.lock}},[t._v(t._s(0==t.tem.lock?"锁定席位":"解除锁定"))]),n("el-button",{attrs:{size:"small",type:"primary",disabled:t.tem.x<1||t.tem.y<1},on:{click:t.saveOneNum}},[t._v("确认修改")])],1),n("div",{staticClass:"contain"},[n("div",{staticClass:"index-container"},[t._l(t.attr.xLen,(function(e){return[n("div",{key:e},[n("span",{staticClass:"index"},[t._v(t._s(e))])])]}))],2),n("div",{staticClass:"table-container"},[t._l(t.attr.xLen,(function(e){return[n("div",{key:e,staticClass:"row"},[t._l(t.attr.yLen,(function(a){return[n("div",{key:a,staticClass:"colunm"},[n("span",{staticClass:"seat",class:{green:t.isGreen(e,a),lock:t.isLock(e,a)},on:{click:function(n){return t.showPanel(e,a)}}},[t._v(t._s(t.num(e,a)))])])]}))],2)]}))],2)])])},o=[],l={props:{attr:{type:Object,default:function(){return{}}},Arr:{type:Array}},data:function(){return{tem:{num:"",x:null,y:null,lock:!1}}},mounted:function(){console.log("座位表挂载")},methods:{isGreen:function(t,e){return!!this.Arr[t-1][e-1]&&null!==this.Arr[t-1][e-1].num},isLock:function(t,e){return!!this.Arr[t-1][e-1]&&this.Arr[t-1][e-1].lock},num:function(t,e){return this.Arr[t-1][e-1]&&null!==this.Arr[t-1][e-1].num?this.Arr[t-1][e-1].num:""},showPanel:function(t,e){this.tem.num=this.Arr[t-1][e-1].num,this.tem.x=t,this.tem.y=e,this.tem.lock=this.Arr[t-1][e-1].lock,this.$refs.input.focus()},lock:function(){var t=this.tem;t.lock=!t.lock,t.num=null,this.Arr[t.x-1][t.y-1].num=null,this.$emit("lock",t.x-1,t.y-1,t.lock)},saveOneNum:function(){var t=this.tem;this.$emit("num",t.x-1,t.y-1,t.num)}}},u=l,f=(n("e4ca"),n("2877")),d=Object(f["a"])(u,c,o,!1,null,"49be891c",null),p=d.exports,m=n("9037"),v=n("0c6d"),b={components:{mTable:s["a"],sTable:p},data:function(){return{activityTable:{tableConfig:[{prop:"id",label:"活动序号",width:"100"},{prop:"name",label:"活动名称"},{prop:"openDate",label:"开放报名时间"},{prop:"date",label:"举办时间"},{prop:"address",label:"地点"},{prop:"fee",label:"费用"},{label:"操作",fixed:"right",slot:"oper",width:"300px"}],tableData:[],tableAttr:{stripe:!0},loading:!1},drwaerInfo:{id:null,name:null,date:null,address:null,fee:null,introduciotn:[],contacts:"唐先生 13535789321"},drawer:!1,fileList:[],seatInfo:{id:null,xLen:0,yLen:0,x:0,y:0,arr:null},flag:!1,tableFlag:!0}},mounted:function(){this.init()},methods:{init:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m["a"].getActivityList();case 3:e=t.sent,this.activityTable.tableData=e.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$message.error(t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}(),handleLock:function(t,e,n){this.seatInfo.arr[t][e].lock=n},handleNum:function(t,e,n){var a=this;this.tableFlag=!1,this.seatInfo.arr[t][e].num=""===n?null:n,this.$nextTick((function(){a.tableFlag=!0}))},checkDetail:function(t){this.drawer=!0,this.drwaerInfo=t},handleSEAT:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.seatInfo){t.next=13;break}return t.prev=1,t.next=4,m["a"].getSEATInfo(e.id);case 4:n=t.sent,this.seatInfo=n.data,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),this.$message.error("获取座位信息失败");case 11:t.next=14;break;case 13:this.$prompt("请输入座位行列数，如8*8","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[0-9]+\*[0-9]+/,inputErrorMessage:"格式不正确"}).then((function(t){var e=t.value.split("*");if(e[0]=Number.parseInt(e[0]),e[1]=Number.parseInt(e[1]),0==e[0]||0==e[1])throw new Error("ss");if(e[0]>30||e[1]>30)a.$message({type:"info",message:"行列数过多，建议使用Excel导入座位"});else{a.seatInfo.xLen=e[0],a.seatInfo.yLen=e[1],a.seatInfo.arr=new Array(e[0]);for(var n=0;n<e[0];n++){a.seatInfo.arr[n]=new Array(e[1]);for(var r=0;r<e[1];r++)a.seatInfo.arr[n][r]={num:null,lock:!1}}a.flag=!0}})).catch((function(t){console.log(t),"ss"==t&&a.$message({type:"info",message:"行列数必须大于0"})}));case 14:this.seatInfo.id=e.id,this.flag=!0;case 16:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}(),autoSEAT:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确定要自动安排座位吗？","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m["a"].autoSEAT(e.id);case 3:t.sent,n.$message.success("自动排位成功"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),n.$message.error(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),beforeRemove:function(){},handleExceed:function(){},beforeClose:function(t){this.$confirm("确定关闭座位表吗？","请保存您的编辑，否则将会丢失此次编辑",{confirmButtonText:"确定，我已经保存",cancelButtonText:"取消",type:"warning"}).then((function(){t()})).catch((function(){}))},saveSEAT:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={activityId:this.seatInfo.id,data:this.seatInfo.arr},t.prev=1,t.next=4,m["a"].setSEATInfo(e);case 4:t.sent,this.$message.success("保存成功"),this.init(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),this.$message.error(t.t0.message);case 12:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(){return t.apply(this,arguments)}return e}(),exportEntryForm:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m["a"].getEntryForm(this.drwaerInfo.id);case 3:e=t.sent,Object(v["b"])(e),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$message.error(t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()}},h=b,g=(n("69ee"),Object(f["a"])(h,a,r,!1,null,"a189a668",null));e["default"]=g.exports},"47e6":function(t,e,n){},"69ee":function(t,e,n){"use strict";var a=n("47e6"),r=n.n(a);r.a},9037:function(t,e,n){"use strict";var a=n("0c6d"),r=n("b441"),i=function(t){return Object(a["c"])(r["a"]+"/addNewActivity","post",t)},s=function(){return Object(a["c"])(r["a"]+"/getActivityList","get")},c=function(t){return Object(a["c"])(r["a"]+"/getActivitySEAT","get",{activityId:t})},o=function(t){return Object(a["c"])(r["a"]+"/getEntryForm","get",{activityId:t},"blob")},l=function(){return Object(a["c"])(r["a"]+"/getSEATForm","get",{},"blob")},u=function(t){return Object(a["c"])(r["a"]+"/setSEATInfo","post",t)},f=function(t){return Object(a["c"])(r["a"]+"/autoSEAT","post",{activityId:t})};e["a"]={newActivity:i,getActivityList:s,getSEATInfo:c,getEntryForm:o,getSEATForm:l,setSEATInfo:u,autoSEAT:f}},add5:function(t,e,n){"use strict";var a=n("e01e"),r=n.n(a);r.a},d2a2:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-table",t._g(t._b({directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"tableRef",staticClass:"m-table",attrs:{size:"small",data:t.data,"max-height":t.data?600:200}},"el-table",t.tableAttr,!1),t.tableEvent),[t._l(t.tableConfig,(function(e,a){return[e.slot?t._t(e.slot,null,{params:e,prop:e.prop}):n("el-table-column",t._b({key:a,attrs:{align:"center"}},"el-table-column",e,!1))]}))],2)},r=[],i={name:"m-Table",props:{tableConfig:{type:Array},data:{type:Array},loading:{type:Boolean},tableAttr:{type:Object},tableEvent:{type:Object}}},s=i,c=(n("add5"),n("2877")),o=Object(c["a"])(s,a,r,!1,null,"bcfa35a4",null);e["a"]=o.exports},e01e:function(t,e,n){},e4ca:function(t,e,n){"use strict";var a=n("f9ad"),r=n.n(a);r.a},f9ad:function(t,e,n){}}]);